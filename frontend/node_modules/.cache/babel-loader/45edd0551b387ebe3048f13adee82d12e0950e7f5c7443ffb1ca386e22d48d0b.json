{"ast":null,"code":"/**\n * Feed Slice - FIXED: Mejor manejo de errores\n */\n\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { postsAPI } from '../../services/api';\nconst initialState = {\n  posts: [],\n  loading: false,\n  error: null,\n  mode: 'all',\n  hasMore: true\n};\n\n/**\n * Fetch feed\n * Backend: GET /users/{username}/feed?mode={mode}&limit={limit}\n */\nexport const fetchFeed = createAsyncThunk('feed/fetchFeed', async ({\n  username,\n  mode = 'all',\n  limit = 20\n}, {\n  rejectWithValue\n}) => {\n  try {\n    console.log('üîÑ Fetching feed:', {\n      username,\n      mode,\n      limit\n    });\n    const response = await postsAPI.getFeed(username, mode, limit);\n    console.log('‚úÖ Feed fetched:', response.data.length, 'posts');\n    return response.data;\n  } catch (error) {\n    console.error('‚ùå Feed fetch error:', error);\n\n    // Manejo espec√≠fico de errores\n    if (error.response) {\n      var _error$response$data;\n      // Error del servidor (404, 500, etc.)\n      const message = ((_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.detail) || `Error ${error.response.status}: ${error.response.statusText}`;\n      return rejectWithValue(message);\n    } else if (error.request) {\n      // Error de red\n      return rejectWithValue('No se pudo conectar al servidor. Verifica tu conexi√≥n.');\n    } else {\n      // Otro error\n      return rejectWithValue(error.message || 'Error desconocido');\n    }\n  }\n});\nconst feedSlice = createSlice({\n  name: 'feed',\n  initialState,\n  reducers: {\n    setMode: (state, action) => {\n      state.mode = action.payload;\n      state.error = null; // Limpiar error al cambiar modo\n    },\n    clearFeed: state => {\n      state.posts = [];\n      state.hasMore = true;\n      state.error = null;\n    },\n    clearError: state => {\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(fetchFeed.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(fetchFeed.fulfilled, (state, action) => {\n      state.loading = false;\n      state.posts = action.payload;\n      state.hasMore = action.payload.length >= 20;\n      state.error = null; // Limpiar error en caso de √©xito\n    }).addCase(fetchFeed.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload || 'Error al cargar el feed';\n      // NO vaciar posts en caso de error (mantener los que hab√≠a)\n    });\n  }\n});\nexport const {\n  setMode,\n  clearFeed,\n  clearError\n} = feedSlice.actions;\nexport default feedSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","postsAPI","initialState","posts","loading","error","mode","hasMore","fetchFeed","username","limit","rejectWithValue","console","log","response","getFeed","data","length","_error$response$data","message","detail","status","statusText","request","feedSlice","name","reducers","setMode","state","action","payload","clearFeed","clearError","extraReducers","builder","addCase","pending","fulfilled","rejected","actions","reducer"],"sources":["/home/rodrigo/Documents/RODRIGO/FI/9noSemestre/NoSql/Proyecto/The_Social_Service/frontend/src/features/feed/feedSlice.js"],"sourcesContent":["/**\n * Feed Slice - FIXED: Mejor manejo de errores\n */\n\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { postsAPI } from '../../services/api';\n\nconst initialState = {\n  posts: [],\n  loading: false,\n  error: null,\n  mode: 'all',\n  hasMore: true,\n};\n\n/**\n * Fetch feed\n * Backend: GET /users/{username}/feed?mode={mode}&limit={limit}\n */\nexport const fetchFeed = createAsyncThunk(\n  'feed/fetchFeed',\n  async ({ username, mode = 'all', limit = 20 }, { rejectWithValue }) => {\n    try {\n      console.log('üîÑ Fetching feed:', { username, mode, limit });\n      const response = await postsAPI.getFeed(username, mode, limit);\n      console.log('‚úÖ Feed fetched:', response.data.length, 'posts');\n      return response.data;\n    } catch (error) {\n      console.error('‚ùå Feed fetch error:', error);\n      \n      // Manejo espec√≠fico de errores\n      if (error.response) {\n        // Error del servidor (404, 500, etc.)\n        const message = error.response.data?.detail || \n                       `Error ${error.response.status}: ${error.response.statusText}`;\n        return rejectWithValue(message);\n      } else if (error.request) {\n        // Error de red\n        return rejectWithValue('No se pudo conectar al servidor. Verifica tu conexi√≥n.');\n      } else {\n        // Otro error\n        return rejectWithValue(error.message || 'Error desconocido');\n      }\n    }\n  }\n);\n\nconst feedSlice = createSlice({\n  name: 'feed',\n  initialState,\n  reducers: {\n    setMode: (state, action) => {\n      state.mode = action.payload;\n      state.error = null; // Limpiar error al cambiar modo\n    },\n    clearFeed: (state) => {\n      state.posts = [];\n      state.hasMore = true;\n      state.error = null;\n    },\n    clearError: (state) => {\n      state.error = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchFeed.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(fetchFeed.fulfilled, (state, action) => {\n        state.loading = false;\n        state.posts = action.payload;\n        state.hasMore = action.payload.length >= 20;\n        state.error = null; // Limpiar error en caso de √©xito\n      })\n      .addCase(fetchFeed.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload || 'Error al cargar el feed';\n        // NO vaciar posts en caso de error (mantener los que hab√≠a)\n      });\n  },\n});\n\nexport const { setMode, clearFeed, clearError } = feedSlice.actions;\nexport default feedSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}