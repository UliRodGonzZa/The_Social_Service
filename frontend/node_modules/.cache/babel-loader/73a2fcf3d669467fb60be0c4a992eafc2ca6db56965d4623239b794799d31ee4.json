{"ast":null,"code":"/**\n * Posts Slice - Crear posts y likes\n * \n * INTEGRACIÓN NOSQL:\n * - MongoDB: Almacenar post {author_username, content, tags, created_at}\n * - Neo4j: Crear nodo (:Post {id}) y relación (User)-[:POSTED]->(Post)\n * - Redis Cluster: Invalidar cache del feed del autor\n * \n * LIKES:\n * - Redis Cluster (principal):\n *   Key: {post:abc123}:likes:count -> STRING (INCR/DECR)\n *   Key: {post:abc123}:likes:users -> SET de usernames\n *   Key: trending:posts -> ZSET (score = likes)\n * \n * - Neo4j (relaciones):\n *   (User)-[:LIKES]->(Post)\n * \n * - MongoDB (persistencia eventual):\n *   Sincronizar contador cada 5 minutos\n * \n * REDIS CLUSTER:\n * - {post:abc123}:likes:count -> hash(\"post:abc123\") -> slot -> Master\n * - {post:abc123}:likes:users -> mismo slot (mismo master)\n * - Pipeline atómico: INCR + SADD + ZINCRBY en un solo nodo\n */\n\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { postsAPI } from '../../services/api';\nconst initialState = {\n  loading: false,\n  error: null,\n  lastCreatedPost: null\n};\n\n/**\n * Crear post\n * \n * Backend: POST /posts/\n * \n * Flujo:\n * 1. MongoDB: Insert post document\n * 2. Neo4j: CREATE (p:Post {id}), (u)-[:POSTED]->(p)\n * 3. Redis: DELETE {user:author}:feed:* (invalidar cache)\n */\nexport const createPost = createAsyncThunk('posts/createPost', async (postData, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await postsAPI.createPost(postData);\n    return response.data;\n  } catch (error) {\n    var _error$response, _error$response$data;\n    return rejectWithValue(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.detail) || 'Error al crear post');\n  }\n});\nconst postsSlice = createSlice({\n  name: 'posts',\n  initialState,\n  reducers: {\n    clearError: state => {\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(createPost.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(createPost.fulfilled, (state, action) => {\n      state.loading = false;\n      state.lastCreatedPost = action.payload;\n    }).addCase(createPost.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    });\n  }\n});\nexport const {\n  clearError\n} = postsSlice.actions;\nexport default postsSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","postsAPI","initialState","loading","error","lastCreatedPost","createPost","postData","rejectWithValue","response","data","_error$response","_error$response$data","detail","postsSlice","name","reducers","clearError","state","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","actions","reducer"],"sources":["/home/rodrigo/Documents/RODRIGO/FI/9noSemestre/NoSql/Proyecto/The_Social_Service/frontend/src/features/posts/postsSlice.js"],"sourcesContent":["/**\n * Posts Slice - Crear posts y likes\n * \n * INTEGRACIÓN NOSQL:\n * - MongoDB: Almacenar post {author_username, content, tags, created_at}\n * - Neo4j: Crear nodo (:Post {id}) y relación (User)-[:POSTED]->(Post)\n * - Redis Cluster: Invalidar cache del feed del autor\n * \n * LIKES:\n * - Redis Cluster (principal):\n *   Key: {post:abc123}:likes:count -> STRING (INCR/DECR)\n *   Key: {post:abc123}:likes:users -> SET de usernames\n *   Key: trending:posts -> ZSET (score = likes)\n * \n * - Neo4j (relaciones):\n *   (User)-[:LIKES]->(Post)\n * \n * - MongoDB (persistencia eventual):\n *   Sincronizar contador cada 5 minutos\n * \n * REDIS CLUSTER:\n * - {post:abc123}:likes:count -> hash(\"post:abc123\") -> slot -> Master\n * - {post:abc123}:likes:users -> mismo slot (mismo master)\n * - Pipeline atómico: INCR + SADD + ZINCRBY en un solo nodo\n */\n\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { postsAPI } from '../../services/api';\n\nconst initialState = {\n  loading: false,\n  error: null,\n  lastCreatedPost: null,\n};\n\n/**\n * Crear post\n * \n * Backend: POST /posts/\n * \n * Flujo:\n * 1. MongoDB: Insert post document\n * 2. Neo4j: CREATE (p:Post {id}), (u)-[:POSTED]->(p)\n * 3. Redis: DELETE {user:author}:feed:* (invalidar cache)\n */\nexport const createPost = createAsyncThunk(\n  'posts/createPost',\n  async (postData, { rejectWithValue }) => {\n    try {\n      const response = await postsAPI.createPost(postData);\n      return response.data;\n    } catch (error) {\n      return rejectWithValue(error.response?.data?.detail || 'Error al crear post');\n    }\n  }\n);\n\nconst postsSlice = createSlice({\n  name: 'posts',\n  initialState,\n  reducers: {\n    clearError: (state) => {\n      state.error = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(createPost.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(createPost.fulfilled, (state, action) => {\n        state.loading = false;\n        state.lastCreatedPost = action.payload;\n      })\n      .addCase(createPost.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload;\n      });\n  },\n});\n\nexport const { clearError } = postsSlice.actions;\nexport default postsSlice.reducer;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,SAASC,QAAQ,QAAQ,oBAAoB;AAE7C,MAAMC,YAAY,GAAG;EACnBC,OAAO,EAAE,KAAK;EACdC,KAAK,EAAE,IAAI;EACXC,eAAe,EAAE;AACnB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,UAAU,GAAGN,gBAAgB,CACxC,kBAAkB,EAClB,OAAOO,QAAQ,EAAE;EAAEC;AAAgB,CAAC,KAAK;EACvC,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMR,QAAQ,CAACK,UAAU,CAACC,QAAQ,CAAC;IACpD,OAAOE,QAAQ,CAACC,IAAI;EACtB,CAAC,CAAC,OAAON,KAAK,EAAE;IAAA,IAAAO,eAAA,EAAAC,oBAAA;IACd,OAAOJ,eAAe,CAAC,EAAAG,eAAA,GAAAP,KAAK,CAACK,QAAQ,cAAAE,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBD,IAAI,cAAAE,oBAAA,uBAApBA,oBAAA,CAAsBC,MAAM,KAAI,qBAAqB,CAAC;EAC/E;AACF,CACF,CAAC;AAED,MAAMC,UAAU,GAAGf,WAAW,CAAC;EAC7BgB,IAAI,EAAE,OAAO;EACbb,YAAY;EACZc,QAAQ,EAAE;IACRC,UAAU,EAAGC,KAAK,IAAK;MACrBA,KAAK,CAACd,KAAK,GAAG,IAAI;IACpB;EACF,CAAC;EACDe,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAACf,UAAU,CAACgB,OAAO,EAAGJ,KAAK,IAAK;MACtCA,KAAK,CAACf,OAAO,GAAG,IAAI;MACpBe,KAAK,CAACd,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDiB,OAAO,CAACf,UAAU,CAACiB,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MAChDN,KAAK,CAACf,OAAO,GAAG,KAAK;MACrBe,KAAK,CAACb,eAAe,GAAGmB,MAAM,CAACC,OAAO;IACxC,CAAC,CAAC,CACDJ,OAAO,CAACf,UAAU,CAACoB,QAAQ,EAAE,CAACR,KAAK,EAAEM,MAAM,KAAK;MAC/CN,KAAK,CAACf,OAAO,GAAG,KAAK;MACrBe,KAAK,CAACd,KAAK,GAAGoB,MAAM,CAACC,OAAO;IAC9B,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAER;AAAW,CAAC,GAAGH,UAAU,CAACa,OAAO;AAChD,eAAeb,UAAU,CAACc,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}